(program
  (class Animal IO
    (attr name String)
    (attr age Int)
    (method init (n:String a:Int) Animal
      (block
        (block
          (assign name
            (object n)
          )
          (assign age
            (object a)
          )
          (object self)
        )
      )
    )
    (method describe () Object
      (block
        (block
          (call out_string
            (string "Animal: ")
          )
          (call out_string
            (object name)
          )
          (call out_string
            (string ", age = ")
          )
          (call out_int
            (object age)
          )
          (call out_string
            (string "
")
          )
        )
      )
    )
  )
  (class Lion Animal
    (method speak () String
      (block
        (string "Roaaar!")
      )
    )
    (method hunt () String
      (block
        (string "The lion hunts its prey.")
      )
    )
  )
  (class Elephant Animal
    (method speak () String
      (block
        (string "Pawooo!")
      )
    )
    (method remember () String
      (block
        (string "The elephant never forgets.")
      )
    )
  )
  (class Parrot Animal
    (attr phrase String
      (string "Hello!")
    )
    (method set_phrase (p:String) Parrot
      (block
        (block
          (assign phrase
            (object p)
          )
          (object self)
        )
      )
    )
    (method speak () String
      (block
        (object phrase)
      )
    )
  )
  (class Zoo IO
    (attr animals List
      (new List)
    )
    (method add (a:Animal) Zoo
      (block
        (block
          (assign animals
            (call cons
              (object animals)
              (object a)
            )
          )
          (object self)
        )
      )
    )
    (method show_all () Object
      (block
        (let
          (current List
            (object animals)
          )
          (while
            (not
              (call is_empty
                (object current)
              )
            )
            (block
              (let
                (a Animal
                  (call head
                    (object current)
                  )
                )
                (block
                  (call describe
                    (object a)
                  )
                  (call out_string
                    (string "It says: ")
                  )
                  (call out_string
                    (call speak
                      (object a)
                    )
                  )
                  (call out_string
                    (string "

")
                  )
                )
              )
              (assign current
                (call tail
                  (object current)
                )
              )
            )
          )
        )
      )
    )
  )
  (class List Object
    (attr head_elem Animal)
    (attr tail_list List)
    (attr empty Bool
      (bool true)
    )
    (method is_empty () Bool
      (block
        (object empty)
      )
    )
    (method head () Animal
      (block
        (if
          (object empty)
          (block
            (call abort
            )
            (new Animal)
          )
          (object head_elem)
        )
      )
    )
    (method tail () List
      (block
        (if
          (object empty)
          (block
            (call abort
            )
            (new List)
          )
          (object tail_list)
        )
      )
    )
    (method cons (a:Animal) List
      (block
        (call init_cons
          (new List)
          (object a)
          (object self)
        )
      )
    )
    (method init_cons (a:Animal t:List) List
      (block
        (block
          (assign head_elem
            (object a)
          )
          (assign tail_list
            (object t)
          )
          (assign empty
            (bool false)
          )
          (object self)
        )
      )
    )
  )
  (class Main IO
    (attr zoo Zoo
      (new Zoo)
    )
    (method main () Object
      (block
        (block
          (call add
            (object zoo)
            (call init
              (new Lion)
              (string "Simba")
              (int 5)
            )
          )
          (call add
            (object zoo)
            (call init
              (new Elephant)
              (string "Dumbo")
              (int 10)
            )
          )
          (call add
            (object zoo)
            (call set_phrase
              (call init
                (new Parrot)
                (string "Kesha")
                (int 2)
              )
              (string "Polly wants a cracker!")
            )
          )
          (call out_string
            (string "Welcome to the Cool Zoo!

")
          )
          (call show_all
            (object zoo)
          )
        )
      )
    )
  )
)
